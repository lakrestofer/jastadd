// Test contribution to interface-hosted collection that was transitively inherited
// https://bitbucket.org/jastadd/jastadd2/issue/204/multi-level-interface-inheritance-of
// .grammar { A ::= B*; B ::= <ID>; }

import static runtime.Test.*;

import java.util.Collection;
import java.util.HashSet;

aspect Test {
    inh A B.a();
    eq A.getB().a() = this;

    interface I { }
    interface J { }
    J implements I;
    A implements J;

    coll Collection<String> I.set() [new HashSet<String>()] with add;
    B contributes getID() to I.set() for a();

    public class Test {
	public static void main(String[] args) {
	    A a = new A();
	    a.addB(new B("1"));
	    a.addB(new B("2"));

	    testTrue(a.set().contains("1"));
	    testTrue(a.set().contains("2"));
	    testEqual(2, a.set().size());
	}
    }
}
