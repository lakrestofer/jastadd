// Override priority
// .grammar: { S ::= A; A ::= E0:E E1:E E2:E E3:E; B:A; E; }
// .result: EXEC_PASS
import static runtime.Test.*;
aspect Test20 {
    interface Foo { }
    interface I { }
    interface J extends I { }

    inh String Foo.foo();
    E implements Foo;

    A implements I;
    B implements J;
    // Subtyping:
    //  A -> I
    //  ^    ^
    //  |    |
    //  B -> J

    eq A.getE0().foo() = "A.0";
    eq I.getE0().foo() = "I.0";

    eq B.getE1().foo() = "B.1";
    eq I.getE1().foo() = "I.1";

    eq A.getE2().foo() = "A.2";
    eq I.getE2().foo() = "I.2";
    eq J.getE2().foo() = "J.2";

    eq A.getE3().foo() = "A.3";
    eq B.getE3().foo() = "B.3";
    eq I.getE3().foo() = "I.3";
    eq J.getE3().foo() = "J.3";

    eq I.getChild().foo() = "I.*";

    public class Test{
        public static void main(String[] args) {
            {
                E e0 = new E();
                E e1 = new E();
                E e2 = new E();
                E e3 = new E();
                A a = new A(e0, e1, e2, e3);
                S s = new S(a);
                testEquals("A.getE0().foo()", "A.0", e0.foo());
                testEquals("A.getE1().foo()", "I.1", e1.foo());
                testEquals("A.getE2().foo()", "A.2", e2.foo());
                testEquals("A.getE3().foo()", "A.3", e3.foo());
            }

            {
                E e0 = new E();
                E e1 = new E();
                E e2 = new E();
                E e3 = new E();
                B b = new B(e0, e1, e2, e3);
                S s = new S(b);
                testEquals("B.getE0().foo()", "A.0", e0.foo());
                testEquals("B.getE1().foo()", "B.1", e1.foo());
                testEquals("B.getE2().foo()", "A.2", e2.foo());
                testEquals("B.getE3().foo()", "B.3", e3.foo());
            }
        }
    }
}
