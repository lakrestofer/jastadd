aspect Test {
	syn Decl Use.decl() = lookup(getName());

	inh Decl Use.lookup(String name);
	eq Program.getExpr(int index).lookup(String name) {
		for (int i = index; i >= 0; --i) {
			Decl decl = getExpr(i).define(name);
			if (decl != null)
				return decl;
		}
		return null;
	}

	syn Decl Expr.define(String name) = null;
	eq Decl.define(String name) =
		name.equals(getName()) ? this : null;
}
